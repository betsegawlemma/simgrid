set(simgrid_version "3.3.5")

set(CMAKE_PROJECT_NAME "${PROJECT_NAME}")
set(CPACK_PACKAGE_NAME "${PROJECT_NAME}")
set(CPACK_PROJECT_NAME "${PROJECT_NAME}")
set(CPACK_PACKAGE_FILE_NAME "simgrid-${simgrid_version}_rev_${SVN_VERSION}")
set(CPACK_GENERATOR "TBZ2") #;TGZ;TZ;ZIP

set(to_svg	
	${XBT_RL_SRC}
	${EXTRA_DIST}
	${SMPI_SRC}
	${JMSG_C_SRC}
	${JMSG_JAVA_SRC}
	${GRAS_RL_SRC}
	${XBT_SRC}
	${GTNETS_SRC}
	${SURF_SRC}
	${SIMIX_SRC}
	${MSG_SRC}
	${SIMDAG_SRC}
	${GRAS_COMMON_SRC}
	${GRAS_SG_SRC}
	${AMOK_SRC}
	${LUA_SRC}
	${RUBY_SRC}
	${add_src_files}
	${include_files}
	${xml_files}
	${tesh_files}
	${txt_files}
	${PROJECT_DIRECTORY}/./CMakeLists.txt
	${PROJECT_DIRECTORY}/./AUTHORS
	${PROJECT_DIRECTORY}/./ChangeLog
	${PROJECT_DIRECTORY}/./COPYING
	${PROJECT_DIRECTORY}/./missing
	${PROJECT_DIRECTORY}/./NEWS
	${PROJECT_DIRECTORY}/./README
	${PROJECT_DIRECTORY}/./README.IEEE
	${PROJECT_DIRECTORY}/./TODO
)
	
foreach(file ${to_svg})
	get_filename_component(file_location ${file} PATH)
	string(REPLACE "${PROJECT_DIRECTORY}/" "/" file_location ${file_location})
	#message("install: ${file}\nDESTINATION: ${file_location}")
	install(FILES ${file} DESTINATION "${file_location}")
endforeach(file ${EXTRA_DIST})

###copy doc
install(DIRECTORY "${PROJECT_DIRECTORY}/doc/"
DESTINATION "/doc/"
PATTERN ".svn" EXCLUDE 
PATTERN ".git" EXCLUDE 
PATTERN "*~" EXCLUDE
)

###buildtools 
install(DIRECTORY "${PROJECT_DIRECTORY}/buildtools/Cmake/"
DESTINATION "/buildtools/Cmake/"
PATTERN ".svn" EXCLUDE 
PATTERN ".git" EXCLUDE 
PATTERN "*~" EXCLUDE
)

set(CPACK_SET_DESTDIR on)
set(CMAKE_INSTALL_PREFIX ${prefix} CACHE TYPE INTERNAL FORCE)

add_custom_target(install-simgrid
COMMAND mkdir -p ${prefix}
COMMAND mkdir -p ${prefix}/lib
COMMAND mkdir -p ${prefix}/include
COMMAND mkdir -p ${prefix}/doc
COMMAND mkdir -p ${prefix}/doc/simgrid
COMMAND mkdir -p ${prefix}/doc/simgrid/html
COMMAND cp -rf ${PROJECT_DIRECTORY}/src/.libs/* ${prefix}/lib/
COMMAND echo "install lib ok"
COMMAND cp -rf ${PROJECT_DIRECTORY}/include/ ${prefix}
COMMAND echo "install include ok"
COMMAND cp -rf ${PROJECT_DIRECTORY}/doc/html/ ${prefix}/doc/simgrid
COMMAND echo "install doc ok"
)

add_custom_target(uninstall
COMMAND echo "uninstall simgrid"
COMMAND echo "TODO"
)

include(CPack)
