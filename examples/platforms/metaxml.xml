<!-- This platform shows the use of traces, clusters and sets of hosts defined with the new XML format. It also explains how to define
      routes between sets of hosts using the route:multi tag
 -->
 <?xml version='1.0'?>
 <!DOCTYPE platform SYSTEM "simgrid.dtd">
 <platform version="2">
 <AS  id="AS0"  routing="Full">
 
   <!-- define a trace inside the XML file -->
   <trace id="mytrace" periodicity="12">
 	5 100    <!-- new value at time 5  is 100 -->
 	12 200   <!-- new value at time 12 is 200 -->
 	15 140   <!-- new value at time 15 is 140 -->
 	<!-- value will stay at 140 for 12 more seconds (the periodicity parameter), and go back on top of the trace afterward) -->
   </trace>
 
   <!-- define a cluster for Nancy. Hosts, links, backbone, routes for inter linkage and external linkage are generated by the parser automatically --> 
   <cluster id="Nancy" prefix="nancy_" radical="0-2" suffix="_host" power="1234566789" bw="125000000" lat="0.00005" bb_bw="50000000" bb_lat="0.001"/>
 
   <!-- Now we will define in 5 steps the same thing for cluster Lille but using the tags foreach and route:multi -->
 
   <!-- 1. Define Lille set -->
   <set id="Lille" prefix="lille_" suffix="_host" radical="0-2"/>
 
   <!-- 2. Define the Lille group (host+link) -->
   <foreach set_id="Lille">
     <host id="$1" power="1234566789"/>
     <link id="$1" bandwidth="125000000" latency="0.00005"/>
   </foreach>
 
   <!-- 3. Backbones for Lille hosts -->
   <link id="Lille_bb" bandwidth="50000000" latency="0.00005"/>
 
   <!-- Define backbone for communication between Nancy and Lille-->
   <link id="INTER-bb" bandwidth="125000000" latency="0.000100"/>
 
   <!-- 4. Define startpoint for Lille -> $* (All other hosts including Nancy hosts) routes. It is the starting point so it overrides all previosly routes!!! -->
   <route:multi src="Lille" dst="$*" action="OVERRIDE" symmetric="NO">
     <link:ctn id="$src"/>
   </route:multi>
 
   <!-- 5. Define Lille intra-cluster communication. Default behaviour POSTPEND links to already existing routes, and NOT symmetric because all routes are created in the first pass.  If you choose symmetric you will duplicate links due to POSTPEND !!!-->
   <route:multi src="Lille" dst="Lille" symmetric="NO">
     <link:ctn id="Lille_bb"/>
   </route:multi>
 
   <!-- Add other links to routes. Default behaviour POSTPEND links to already existing routes -->
   <route:multi src="Nancy" dst="Lille">
     <link:ctn id="INTER-bb"/>
     <link:ctn id="$dst"/>
   </route:multi>
   
   <!-- Connect the trace with the host nancy_0_host -->
   <trace:connect trace="mytrace" kind="POWER" element="nancy_0_host"/>
 
 </AS>
 </platform>
